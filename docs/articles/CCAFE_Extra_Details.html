<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CCAFE Extra Details â€¢ CCAFE</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="CCAFE Extra Details">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CCAFE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/CCAFE.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CCAFE_CCGWAS.html">CCAFE CC-GWAS Example</a>
    </li>
    <li>
      <a href="../articles/CCAFE_Extra_Details.html">CCAFE Extra Details</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wolffha/CCAFE/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>CCAFE Extra Details</h1>
                        <h4 data-toc-skip class="author">Hayley
Stoneman</h4>
            
            <h4 data-toc-skip class="date">2024-07-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/wolffha/CCAFE/blob/HEAD/vignettes/CCAFE_Extra_Details.Rmd" class="external-link"><code>vignettes/CCAFE_Extra_Details.Rmd</code></a></small>
      <div class="hidden name"><code>CCAFE_Extra_Details.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this vignette we will share a few extra details regarding the
usage of the functions in CCAFE.</p>
<p>For the vignette with basic usage and examples see the CCAFE
Vignette.</p>
<div class="section level3">
<h3 id="simulated-dataset">Simulated dataset<a class="anchor" aria-label="anchor" href="#simulated-dataset"></a>
</h3>
<p>Will create a simulated dataset to explore the issues discussed in
this vignette.</p>
<p>This dataset will have:</p>
<ul>
<li>2400 variants (100 on each chromosome)</li>
<li>10000 cases and 10000 controls
<ul>
<li>5000 XX cases and 5000 XY cases</li>
<li>5000 XX controls and 5000 XY controls</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># need to create simulated AFs from autosomes and sex chromosomes</span></span>
<span></span>
<span><span class="co"># simulate 100 variants from each chromosome</span></span>
<span></span>
<span><span class="co"># will simulate from a sample of 5000 XX and 5000 XY case individuals</span></span>
<span><span class="co"># then add 5000 of each in control</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span></span>
<span></span>
<span><span class="va">N_XX</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span>
<span><span class="va">N_XY</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="va">N_XX</span> <span class="op">+</span> <span class="va">N_XY</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">chr</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">24</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">refs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">chr</span> <span class="op">&lt;</span> <span class="fl">23</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">genos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">refs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/Multinom.html" class="external-link">rmultinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">N</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">*</span><span class="va">x</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">x</span><span class="op">)</span>, <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">afs_toadd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">genos</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">N</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">chr</span> <span class="op">==</span> <span class="fl">23</span><span class="op">)</span> <span class="op">{</span> <span class="co"># simulate X chromosome variants</span></span>
<span>      <span class="va">XX_alleles</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">refs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">N_XX</span><span class="op">*</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">XY_alleles</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">refs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">N_XY</span>, <span class="fl">1</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="va">total_alleles</span> <span class="op">&lt;-</span> <span class="va">XX_alleles</span> <span class="op">+</span> <span class="va">XY_alleles</span></span>
<span>      <span class="va">afs_toadd</span> <span class="op">&lt;-</span> <span class="va">total_alleles</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">N_XX</span> <span class="op">+</span> <span class="va">N_XY</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span> <span class="co"># simulate Y chromosome variants</span></span>
<span>      <span class="va">XY_alleles</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">refs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">N_XY</span>, <span class="fl">1</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="va">afs_toadd</span> <span class="op">&lt;-</span> <span class="va">XY_alleles</span><span class="op">/</span><span class="op">(</span><span class="va">N_XY</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">chr</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">simDat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>chr <span class="op">=</span> <span class="va">chr</span>, pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span>, case_sim_af <span class="op">=</span> <span class="va">afs_toadd</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">simDat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">simDat</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>chr <span class="op">=</span> <span class="va">chr</span>, pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span>, case_sim_af <span class="op">=</span> <span class="va">afs_toadd</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">simDat</span><span class="op">$</span><span class="va">control_sim_af</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># simulate control AFs</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">chr</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">24</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">refs</span> <span class="op">&lt;-</span> <span class="va">simDat</span><span class="op">[</span><span class="va">simDat</span><span class="op">$</span><span class="va">chr</span> <span class="op">==</span> <span class="va">chr</span>,<span class="op">]</span><span class="op">$</span><span class="va">case_sim_af</span></span>
<span>  <span class="va">refs</span> <span class="op">&lt;-</span> <span class="va">refs</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">refs</span><span class="op">)</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">.025</span><span class="op">)</span></span>
<span>  <span class="va">refs</span><span class="op">[</span><span class="va">refs</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="va">refs</span><span class="op">[</span><span class="va">refs</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">chr</span> <span class="op">&lt;</span> <span class="fl">23</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">genos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">refs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/Multinom.html" class="external-link">rmultinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">N</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">*</span><span class="va">x</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">x</span><span class="op">)</span>, <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">afs_toadd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">genos</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">N</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">chr</span> <span class="op">==</span> <span class="fl">23</span><span class="op">)</span> <span class="op">{</span> <span class="co"># simulate X chromosome variants</span></span>
<span>      <span class="va">XX_alleles</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">refs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">N_XX</span><span class="op">*</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">XY_alleles</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">refs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">N_XY</span>, <span class="fl">1</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="va">total_alleles</span> <span class="op">&lt;-</span> <span class="va">XX_alleles</span> <span class="op">+</span> <span class="va">XY_alleles</span></span>
<span>      <span class="va">afs_toadd</span> <span class="op">&lt;-</span> <span class="va">total_alleles</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">N_XX</span> <span class="op">+</span> <span class="va">N_XY</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span> <span class="co"># simulate Y chromosome variants</span></span>
<span>      <span class="va">XY_alleles</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">refs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">N_XY</span>, <span class="fl">1</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="va">afs_toadd</span> <span class="op">&lt;-</span> <span class="va">XY_alleles</span><span class="op">/</span><span class="op">(</span><span class="va">N_XY</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">simDat</span><span class="op">[</span><span class="va">simDat</span><span class="op">$</span><span class="va">chr</span> <span class="op">==</span> <span class="va">chr</span>, <span class="op">]</span><span class="op">$</span><span class="va">control_sim_af</span> <span class="op">&lt;-</span> <span class="va">afs_toadd</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">simDat</span><span class="op">$</span><span class="va">total_sim_af</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">simDat</span><span class="op">$</span><span class="va">case_sim_af</span><span class="op">*</span><span class="fl">10000</span> <span class="op">+</span> <span class="va">simDat</span><span class="op">$</span><span class="va">control_sim_af</span><span class="op">*</span><span class="fl">10000</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">10000</span> <span class="op">+</span> <span class="fl">10000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># need to add OR and SE</span></span>
<span><span class="va">OR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">simDat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">SE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">simDat</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">simDat</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">AF1</span> <span class="op">=</span> <span class="va">simDat</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span><span class="op">$</span><span class="va">case_sim_af</span></span>
<span>  <span class="va">AF2</span> <span class="op">=</span> <span class="va">simDat</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">$</span><span class="va">control_sim_af</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">simDat</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">$</span><span class="va">chr</span> <span class="op">&lt;</span> <span class="fl">23</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># first calculate the 2x2 tables of allele counts</span></span>
<span>    <span class="va">a</span> <span class="op">=</span> <span class="va">AF1</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="fl">10000</span> </span>
<span>    <span class="va">b</span> <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">AF1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="fl">10000</span></span>
<span>    <span class="va">c</span> <span class="op">=</span> <span class="va">AF2</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="fl">10000</span></span>
<span>    <span class="va">d</span> <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">AF2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="fl">10000</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">simDat</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">$</span><span class="va">chr</span> <span class="op">==</span> <span class="fl">23</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">a</span> <span class="op">=</span> <span class="va">AF1</span> <span class="op">*</span> <span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fl">5000</span> <span class="op">+</span> <span class="fl">5000</span><span class="op">)</span></span>
<span>      <span class="va">b</span> <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">AF1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fl">5000</span> <span class="op">+</span> <span class="fl">5000</span><span class="op">)</span></span>
<span>      <span class="va">c</span> <span class="op">=</span> <span class="va">AF2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fl">5000</span> <span class="op">+</span> <span class="fl">5000</span><span class="op">)</span></span>
<span>      <span class="va">d</span> <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">AF2</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fl">5000</span> <span class="op">+</span> <span class="fl">5000</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">a</span> <span class="op">=</span> <span class="va">AF1</span> <span class="op">*</span> <span class="fl">5000</span></span>
<span>      <span class="va">b</span> <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">AF1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">5000</span></span>
<span>      <span class="va">c</span> <span class="op">=</span> <span class="va">AF2</span> <span class="op">*</span> <span class="fl">5000</span></span>
<span>      <span class="va">d</span> <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">AF2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">5000</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">OR</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">a</span><span class="op">*</span><span class="va">d</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">b</span><span class="op">*</span><span class="va">c</span><span class="op">)</span></span>
<span>  <span class="va">SE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">a</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">b</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">c</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">simDat</span><span class="op">$</span><span class="va">OR</span> <span class="op">&lt;-</span> <span class="va">OR</span></span>
<span><span class="va">simDat</span><span class="op">$</span><span class="va">SE</span> <span class="op">&lt;-</span> <span class="va">SE</span></span>
<span></span>
<span><span class="va">simDat</span><span class="op">[</span><span class="va">simDat</span><span class="op">$</span><span class="va">chr</span> <span class="op">==</span> <span class="fl">23</span>, <span class="op">]</span><span class="op">$</span><span class="va">chr</span> <span class="op">&lt;-</span> <span class="st">"X"</span></span>
<span><span class="va">simDat</span><span class="op">[</span><span class="va">simDat</span><span class="op">$</span><span class="va">chr</span> <span class="op">==</span> <span class="fl">24</span>, <span class="op">]</span><span class="op">$</span><span class="va">chr</span> <span class="op">&lt;-</span> <span class="st">"Y"</span></span>
<span></span>
<span><span class="va">simDat</span> <span class="op">&lt;-</span> <span class="va">simDat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html" class="external-link">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>is_minor_case <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">case_sim_af</span> <span class="op">&lt;=</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>         is_minor_control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">control_sim_af</span> <span class="op">&lt;=</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>         is_minor_total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">total_sim_af</span> <span class="op">&lt;=</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>case_sim_maf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">is_minor_case</span>, <span class="va">case_sim_af</span>, <span class="fl">1</span><span class="op">-</span><span class="va">case_sim_af</span><span class="op">)</span>,</span>
<span>         control_sim_maf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">is_minor_control</span>, <span class="va">control_sim_af</span>, <span class="fl">1</span><span class="op">-</span><span class="va">control_sim_af</span><span class="op">)</span>,</span>
<span>         total_sim_maf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">is_minor_total</span>, <span class="va">total_sim_af</span>, <span class="fl">1</span><span class="op">-</span><span class="va">total_sim_af</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simDat</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 Ã— 13</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Rowwise: </span></span></span>
<span><span class="co">#&gt;   chr     pos case_sim_af control_sim_af total_sim_af    OR     SE is_minor_case</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1         1      0.649          0.636        0.642   1.06 0.020<span style="text-decoration: underline;">9</span>             0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1         2      0.394          0.389        0.392   1.02 0.020<span style="text-decoration: underline;">5</span>             1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1         3      0.615          0.591        0.603   1.11 0.020<span style="text-decoration: underline;">4</span>             0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1         4      0.476          0.456        0.466   1.09 0.020<span style="text-decoration: underline;">1</span>             1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1         5      0.138          0.117        0.128   1.20 0.030<span style="text-decoration: underline;">0</span>             1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1         6      0.067<span style="text-decoration: underline;">8</span>         0.045<span style="text-decoration: underline;">2</span>       0.056<span style="text-decoration: underline;">6</span>  1.54 0.044<span style="text-decoration: underline;">1</span>             1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 5 more variables: is_minor_control &lt;dbl&gt;, is_minor_total &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   case_sim_maf &lt;dbl&gt;, control_sim_maf &lt;dbl&gt;, total_sim_maf &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="maf-vs-af">MAF vs AF<a class="anchor" aria-label="anchor" href="#maf-vs-af"></a>
</h2>
<div class="section level3">
<h3 id="minor-alleles-in-casecontrol_se">Minor alleles in CaseControl_SE<a class="anchor" aria-label="anchor" href="#minor-alleles-in-casecontrol_se"></a>
</h3>
<p>A key assumption made by the implementation of CaseControl_SE is that
the frequency being estimated is that of the <em>minor</em> allele. As
such, the returned value is always the minor allele and bounded [0,0.5],
regardless of which allele was used for calculation of the input OR and
SE. This can create complications in data harmonization between multiple
datasets, because the minor allele may not always be the same between
the two datasets. We note that care should be taken when using this
method to reconstruct case and control AFs for use in secondary analyses
as the alleles being compared may not be retained.</p>
<div class="section level4">
<h4 id="examples-in-simulated-data">Examples in simulated data<a class="anchor" aria-label="anchor" href="#examples-in-simulated-data"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">simDat</span><span class="op">[</span><span class="va">simDat</span><span class="op">$</span><span class="va">is_minor_case</span> <span class="op">!=</span> <span class="va">simDat</span><span class="op">$</span><span class="va">is_minor_control</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 32</span></span></code></pre></div>
<p>There are 32 variants for which the minor allele is a different
allele in cases and controls.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diff_alleles</span> <span class="op">&lt;-</span> <span class="va">simDat</span><span class="op">[</span><span class="va">simDat</span><span class="op">$</span><span class="va">is_minor_case</span> <span class="op">!=</span> <span class="va">simDat</span><span class="op">$</span><span class="va">is_minor_control</span>, <span class="op">]</span></span>
<span><span class="va">diff_alleles</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 32 Ã— 13</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Rowwise: </span></span></span>
<span><span class="co">#&gt;    chr     pos case_sim_af control_sim_af total_sim_af    OR     SE</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1        95       0.507          0.490        0.498  1.07 0.020<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2        28       0.504          0.493        0.499  1.05 0.020<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 4        47       0.520          0.491        0.505  1.12 0.020<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 6         7       0.504          0.495        0.500  1.04 0.020<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 6        81       0.501          0.496        0.498  1.02 0.020<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 7        57       0.504          0.498        0.501  1.02 0.020<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 7        88       0.519          0.495        0.507  1.10 0.020<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8        14       0.503          0.485        0.494  1.07 0.020<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 8        23       0.522          0.499        0.511  1.10 0.020<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 8        98       0.501          0.481        0.491  1.08 0.020<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 22 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 6 more variables: is_minor_case &lt;dbl&gt;, is_minor_control &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   is_minor_total &lt;dbl&gt;, case_sim_maf &lt;dbl&gt;, control_sim_maf &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   total_sim_maf &lt;dbl&gt;</span></span></span></code></pre></div>
<p>This will results in different alleles being reported from
CaseControl_SE, which, if used for subsequent analyses like case case
GWAS (CC-GWAS) would result in the user comparing different alleles
between datasets/groups.</p>
</div>
</div>
<div class="section level3">
<h3 id="using-total-minor-allele-frequency-in-casecontrol_af">Using total minor allele frequency in CaseControl_AF<a class="anchor" aria-label="anchor" href="#using-total-minor-allele-frequency-in-casecontrol_af"></a>
</h3>
<p>In analyses for the manuscript we assessed using the total sample MAF
compared to the total sample AF. Here we noted that converting the total
AF to MAF first (and using that as input) introduces variability due to
rounding.</p>
<div class="section level4">
<h4 id="demonstration-in-simulations">Demonstration in simulations<a class="anchor" aria-label="anchor" href="#demonstration-in-simulations"></a>
</h4>
<p>Here we will show the effects of converting to MAF in 3
scenarios:</p>
<ol style="list-style-type: decimal">
<li>No AF conversions for calculations, No conversions for
comparison</li>
<li>No AF conversions for calculations, convert to MAF for
comparison</li>
<li>Convert to MAF for calculations, covert to MAF for comparison</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simDat</span> <span class="op">&lt;-</span> <span class="va">simDat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">simDat</span><span class="op">$</span><span class="va">OR</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">simDat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">simDat</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_AF</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CaseControl_AF.html">CaseControl_AF</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simDat</span>,</span>
<span>                         N_case <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                         N_control <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                         OR_colname <span class="op">=</span> <span class="st">"OR"</span>,</span>
<span>                         AF_total_colname <span class="op">=</span> <span class="st">"total_sim_af"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_MAF</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CaseControl_AF.html">CaseControl_AF</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simDat</span>,</span>
<span>                         N_case <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                         N_control <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                         OR_colname <span class="op">=</span> <span class="st">"OR"</span>,</span>
<span>                         AF_total_colname <span class="op">=</span> <span class="st">"total_sim_maf"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">res_AF</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">case_sim_af</span>, y <span class="op">=</span> <span class="va">AF_case</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"True AF"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Estimated AF"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">.175</span>, y <span class="op">=</span> <span class="fl">.9</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"CCC="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/CCC.html" class="external-link">CCC</a></span><span class="op">(</span><span class="va">res_AF</span><span class="op">$</span><span class="va">case_sim_af</span>, <span class="va">res_AF</span><span class="op">$</span><span class="va">AF_case</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">$</span><span class="va">rho.c</span><span class="op">$</span><span class="va">est</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"1. No Conversion"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in sqrt(((1 - ((r)^2)) * (p)^2 * (1 - ((p)^2))/(r)^2 + (2 * (p)^3 * :</span></span>
<span><span class="co">#&gt; NaNs produced</span></span>
<span></span>
<span><span class="va">res_AF</span><span class="op">$</span><span class="va">MAF_case</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">res_AF</span><span class="op">$</span><span class="va">AF_case</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">-</span><span class="va">x</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res_AF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">res_AF</span><span class="op">)</span></span>
<span><span class="va">p_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">res_AF</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">case_sim_maf</span>, y <span class="op">=</span> <span class="va">MAF_case</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"True MAF"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Estimated MAF"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">.1</span>, y <span class="op">=</span> <span class="fl">.45</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"CCC="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/CCC.html" class="external-link">CCC</a></span><span class="op">(</span><span class="va">res_AF</span><span class="op">$</span><span class="va">case_sim_maf</span>, <span class="va">res_AF</span><span class="op">$</span><span class="va">MAF_case</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">$</span><span class="va">rho.c</span><span class="op">$</span><span class="va">est</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"2. Convert AFTER"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in sqrt(((1 - ((r)^2)) * (p)^2 * (1 - ((p)^2))/(r)^2 + (2 * (p)^3 * :</span></span>
<span><span class="co">#&gt; NaNs produced</span></span>
<span></span>
<span><span class="va">p_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">res_MAF</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">case_sim_maf</span>, y <span class="op">=</span> <span class="va">AF_case</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"True MAF"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Estimated MAF"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">.1</span>, y <span class="op">=</span> <span class="fl">.48</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"CCC="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/CCC.html" class="external-link">CCC</a></span><span class="op">(</span><span class="va">res_MAF</span><span class="op">$</span><span class="va">case_sim_maf</span>, <span class="va">res_MAF</span><span class="op">$</span><span class="va">AF_case</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">$</span><span class="va">rho.c</span><span class="op">$</span><span class="va">est</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"3. Convert BEFORE"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">p_1</span>, <span class="va">p_2</span>, <span class="va">p_3</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 5 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 5 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span>
<span><span class="co">#&gt; Removed 5 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<p><img src="CCAFE_Extra_Details_files/figure-html/Plot_AF_results-1.png" width="100%">
Here itâ€™s clear to see that as long as the user does not convert to MAF
before estimating the case and control AFs, then we get perfect
reconstruction of the AFs. Conversely, converting the total sample AF to
MAF first introduces variability around the estimates (seen in scenario
3). Overall, the estimates are still highly accurate, but when possible
we recommend not converting AFs to MAF before inputting to
CaseControl_AF.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="variants-on-sex-chromosomes">Variants on sex chromosomes<a class="anchor" aria-label="anchor" href="#variants-on-sex-chromosomes"></a>
</h2>
<p>Another potential problem that users may encounter is the presence of
sex chromosomes when using CaseControl_SE.</p>
<p>The derivation for the framework underlying CaseControl_SE utilizes
the total allele number (AN) for cases and controls. The original
proposed method in ReACt used the equation AN = 2*N, where N is the
sample size. However, this is only true in all samples for autosomes.
This equation will also hold true for the X chromosome in an all
biological female (XX) sample. However, in any sample in which there are
both XX and XY individuals, this equation will not give the correct
total AN for the sex chromosomes.</p>
<p>We have added the ability to estimate the case and control MAF for
the sex chromosomes by employing the following equations for the AN in
the original framework:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><msub><mi>N</mi><mi>X</mi></msub><mo>=</mo><mn>2</mn><mo>*</mo><msub><mi>N</mi><mrow><mi>X</mi><mi>X</mi><mi>i</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>v</mi><mi>i</mi><mi>d</mi><mi>u</mi><mi>a</mi><mi>l</mi><mi>s</mi></mrow></msub><mo>+</mo><msub><mi>N</mi><mrow><mi>X</mi><mi>Y</mi><mi>i</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>v</mi><mi>i</mi><mi>d</mi><mi>u</mi><mi>a</mi><mi>l</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex"> AN_X = 2*N_{XX individuals} + N_{XY individuals} </annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><msub><mi>N</mi><mi>Y</mi></msub><mo>=</mo><msub><mi>N</mi><mrow><mi>X</mi><mi>Y</mi><mi>i</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>v</mi><mi>i</mi><mi>d</mi><mi>u</mi><mi>a</mi><mi>l</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex"> AN_Y = N_{XY individuals} </annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><msub><mi>N</mi><mrow><mi>a</mi><mi>u</mi><mi>t</mi><mi>o</mi><mi>s</mi><mi>o</mi><mi>m</mi><mi>e</mi><mi>s</mi></mrow></msub><mo>=</mo><mn>2</mn><mo>*</mo><mi>N</mi></mrow><annotation encoding="application/x-tex"> AN_{autosomes} = 2*N</annotation></semantics></math>
Failing to use the correct AN resulted in MAF estimates that did not
follow the same trend as the autosomes. We require chromosome data with
the input for CaseControl_SE to check for the presence of variants on
sex chromosomes. Notably, in order to estimate the MAFs for these sex
chromosomes, users must know and provide as input the number of XX and
XY individuals per case and control sample. While it is reasonable to
expect most studies to publish this demographic information, it may not
always be available. In this case, users can set the flag
<em>â€˜remove_sex_chromosomesâ€™</em> to TRUE and the method will return the
MAFs for only autosomal variants. We will demonstrate below what the
results may look like if the sex chromosomes are not properly accounted
for.</p>
<p>The implementation of CaseControl_AF directly uses sample size and
total AF, rather than total AN. Thus this method is not sensitive to the
XX and XY specific samples sizes. We will also show this below.</p>
<div class="section level4">
<h4 id="demonstration-in-simulations-1">Demonstration in simulations<a class="anchor" aria-label="anchor" href="#demonstration-in-simulations-1"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># to simulate a dataset in which the sex chromosomes are not properly accounted for, we will falsely</span></span>
<span><span class="co"># rename the x and y chromosomes to autosomes</span></span>
<span><span class="va">simDat_nosex</span> <span class="op">&lt;-</span> <span class="va">simDat</span></span>
<span><span class="va">simDat_nosex</span><span class="op">[</span><span class="va">simDat_nosex</span><span class="op">$</span><span class="va">chr</span> <span class="op">==</span> <span class="st">"X"</span>, <span class="op">]</span><span class="op">$</span><span class="va">chr</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">simDat_nosex</span><span class="op">[</span><span class="va">simDat_nosex</span><span class="op">$</span><span class="va">chr</span> <span class="op">==</span> <span class="st">"Y"</span>, <span class="op">]</span><span class="op">$</span><span class="va">chr</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">af_res_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CaseControl_AF.html">CaseControl_AF</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simDat</span>,</span>
<span>                           N_case <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                           N_control <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                           OR_colname <span class="op">=</span> <span class="st">"OR"</span>,</span>
<span>                           AF_total_colname <span class="op">=</span> <span class="st">"total_sim_af"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">se_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CaseControl_SE.html">CaseControl_SE</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simDat_nosex</span>,</span>
<span>                                N_case <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                                N_control <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                                OR_colname <span class="op">=</span> <span class="st">"OR"</span>,</span>
<span>                                SE_colname <span class="op">=</span> <span class="st">"SE"</span>,</span>
<span>                                chromosome_colname <span class="op">=</span> <span class="st">"chr"</span>,</span>
<span>                                position_colname <span class="op">=</span> <span class="st">"pos"</span>,</span>
<span>                                sex_chromosomes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                do_correction <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">se_res_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CaseControl_SE.html">CaseControl_SE</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simDat</span>,</span>
<span>                             N_case <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                             N_control <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                             OR_colname <span class="op">=</span> <span class="st">"OR"</span>,</span>
<span>                             SE_colname <span class="op">=</span> <span class="st">"SE"</span>,</span>
<span>                             chromosome_colname <span class="op">=</span> <span class="st">"chr"</span>,</span>
<span>                             position_colname <span class="op">=</span> <span class="st">"pos"</span>,</span>
<span>                             sex_chromosomes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             remove_sex_chromosomes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             do_correction <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             N_XX_case <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>                             N_XX_control <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>                             N_XY_case <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>                             N_XY_control <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></span></code></pre></div>
<p>Examine the following scenarios:</p>
<ol style="list-style-type: decimal">
<li>CaseControl_AF with sex chromosomes</li>
<li>CaseControl_SE with sex chromosomes improperly accounted for</li>
<li>CaseControl_SE with sex chromosomes properly accounted for</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">af_res_sex</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">case_sim_af</span>, y <span class="op">=</span> <span class="va">AF_case</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"True AF"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Estimated AF"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"1. CaseControl_AF"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">se_res</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">case_sim_maf</span>, y <span class="op">=</span> <span class="va">MAF_case</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"True MAF"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Estimated MAF"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"2. CaseControl_SE"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">p_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">se_res_sex</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">case_sim_maf</span>, y <span class="op">=</span> <span class="va">MAF_case</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"True MAF"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Estimated MAF"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"3. CaseControl_SE"</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">p_a</span>, <span class="va">p_b</span>, <span class="va">p_c</span>, ncol <span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 5 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<p><img src="CCAFE_Extra_Details_files/figure-html/plot_sex_chromosome_results-1.png" width="100%"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.1 (2024-06-14 ucrt)</span></span>
<span><span class="co">#&gt; Platform: x86_64-w64-mingw32/x64</span></span>
<span><span class="co">#&gt; Running under: Windows 11 x64 (build 22631)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] LC_COLLATE=English_United States.utf8 </span></span>
<span><span class="co">#&gt; [2] LC_CTYPE=English_United States.utf8   </span></span>
<span><span class="co">#&gt; [3] LC_MONETARY=English_United States.utf8</span></span>
<span><span class="co">#&gt; [4] LC_NUMERIC=C                          </span></span>
<span><span class="co">#&gt; [5] LC_TIME=English_United States.utf8    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: America/Denver</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] cowplot_1.1.3     DescTools_0.99.55 CCAFE_0.99.0      lubridate_1.9.3  </span></span>
<span><span class="co">#&gt;  [5] forcats_1.0.0     stringr_1.5.1     dplyr_1.1.4       purrr_1.0.2      </span></span>
<span><span class="co">#&gt;  [9] readr_2.1.5       tidyr_1.3.1       tibble_3.2.1      ggplot2_3.5.1    </span></span>
<span><span class="co">#&gt; [13] tidyverse_2.0.0  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gld_2.6.6         gtable_0.3.5      xfun_0.45         bslib_0.8.0      </span></span>
<span><span class="co">#&gt;  [5] htmlwidgets_1.6.4 lattice_0.22-6    tzdb_0.4.0        vctrs_0.6.5      </span></span>
<span><span class="co">#&gt;  [9] tools_4.4.1       generics_0.1.3    proxy_0.4-27      fansi_1.0.6      </span></span>
<span><span class="co">#&gt; [13] highr_0.11        pkgconfig_2.0.3   Matrix_1.7-0      data.table_1.15.4</span></span>
<span><span class="co">#&gt; [17] desc_1.4.3        readxl_1.4.3      rootSolve_1.8.2.4 lifecycle_1.0.4  </span></span>
<span><span class="co">#&gt; [21] farver_2.1.2      compiler_4.4.1    textshaping_0.4.0 Exact_3.3        </span></span>
<span><span class="co">#&gt; [25] munsell_0.5.1     htmltools_0.5.8.1 class_7.3-22      sass_0.4.9       </span></span>
<span><span class="co">#&gt; [29] yaml_2.3.10       pillar_1.9.0      pkgdown_2.1.0     jquerylib_0.1.4  </span></span>
<span><span class="co">#&gt; [33] MASS_7.3-61       cachem_1.1.0      boot_1.3-31       tidyselect_1.2.1 </span></span>
<span><span class="co">#&gt; [37] digest_0.6.36     mvtnorm_1.2-5     stringi_1.8.4     labeling_0.4.3   </span></span>
<span><span class="co">#&gt; [41] fastmap_1.2.0     grid_4.4.1        colorspace_2.1-1  lmom_3.0         </span></span>
<span><span class="co">#&gt; [45] expm_0.999-9      cli_3.6.3         magrittr_2.0.3    utf8_1.2.4       </span></span>
<span><span class="co">#&gt; [49] e1071_1.7-14      withr_3.0.1       scales_1.3.0      timechange_0.3.0 </span></span>
<span><span class="co">#&gt; [53] httr_1.4.7        rmarkdown_2.28    cellranger_1.1.0  ragg_1.3.2       </span></span>
<span><span class="co">#&gt; [57] hms_1.1.3         evaluate_0.24.0   knitr_1.48        rlang_1.1.4      </span></span>
<span><span class="co">#&gt; [61] Rcpp_1.0.13       glue_1.7.0        rstudioapi_0.16.0 jsonlite_1.8.8   </span></span>
<span><span class="co">#&gt; [65] R6_2.5.1          systemfonts_1.1.0 fs_1.6.4</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Hayley Wolff.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
