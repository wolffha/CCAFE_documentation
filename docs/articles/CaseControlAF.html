<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CaseControlAF Vignette • CaseControlAF</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="CaseControlAF Vignette">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CaseControlAF</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/CaseControlAF.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CaseControlAF%20Extra%20Details.html">CaseControlAF Extra Details</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wolffha/CaseControlAF/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>CaseControlAF Vignette</h1>
                        <h4 data-toc-skip class="author">Hayley
Stoneman</h4>
            
            <h4 data-toc-skip class="date">2024-07-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/wolffha/CaseControlAF/blob/HEAD/vignettes/CaseControlAF.Rmd" class="external-link"><code>vignettes/CaseControlAF.Rmd</code></a></small>
      <div class="hidden name"><code>CaseControlAF.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><em>Motivation</em></p>
<p>Growth in the field of genetic and genomic research has vastly
increased the amount of available data which is often made publicly
available through summary statistics. While there are many opportunities
and new methods to use summary-level genetic data, it is often limited
by the statistics that are made available. Many post-hoc analyses of
disease data require case and control allele frequencies (AFs), which
are not always published. We present a framework to derive the case and
control AFs from Genome Wide Association Study (GWAS) summary statistics
using the whole sample (case and control aggregated) AF, odds ratio, and
case and control sample sizes, and compare it to a previously published
method that uses the standard error (SE), odds ratio, and case and
control sample sizes to recapitulate case and control AFs.</p>
<p><em>Results</em></p>
<p>In simulations and real data, we find estimating case and control AFs
using the whole sample AF is highly accurate across all settings. When
applying this method to the Pan-UK Biobank we find high concordance with
the known AFs. Conversely, we find that in Pan-UK Biobank and
simulations including covariates, deriving case and control AFs from the
SE underestimates the minor AF (MAF) for higher MAFs. To enable
estimation of case and control AFs using SE, we use gnomAD v3.1.2 AFs as
a proxy for true AFs to estimate and correct for bias fit. While
estimating the case control AF using the whole sample AF is preferred
due to its high accuracy, estimating from the SE can be used more
broadly since the SE can be calculated from the p-value and beta
estimate, which are more commonly provided. Both methods expand the
utility of publicly available genetic summary statistics, can be used
when different statistics are reported, and promote the reusability of
genomic data.</p>
<p><br><br> This document introduces you to the functions in
CaseControlAF and gives small examples of how they can be used with
summary statistics.</p>
<p><br><br> Find more details and documentation on GitHub: (<a href="https://wolffha.github.io/CaseControlAF/" class="external-link uri">https://wolffha.github.io/CaseControlAF/</a>)</p>
<p><br><br> To jump forward to individual function specifics:</p>
<p><a href="#CaseControl_AF"><strong>CaseControl_AF</strong></a> – <a href="#a-quick-demo-of-CaseControl_AF">fast forward to example</a></p>
<p><a href="#CaseControl_SE"><strong>CaseControl_SE</strong></a> – <a href="#a-quick-demo-of-CaseControl_SE">fast forward to example</a>
<br><br><br></p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install this package from BioConductor:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.github.io/BiocManager/" class="external-link">"BiocManager"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"CaseControlAF"</span><span class="op">)</span></span></code></pre></div>
<p>To install this package from GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"https://github.com/wolffha/CaseControlAF"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="overview-of-casecontrolaf-functions">Overview of CaseControlAF Functions<a class="anchor" aria-label="anchor" href="#overview-of-casecontrolaf-functions"></a>
</h3>
<p>CaseControlAF contains two functions:</p>
<ul>
<li><strong>CaseControl_AF()</strong></li>
<li><strong>CaseControl_SE()</strong></li>
</ul>
<p>The two functions are both used to reconstruct case and control
allele frequencies (AFs) from genetic summary statistics.</p>
<p>The user will select which function to use based on the available
summary statistics.</p>
<p><strong>CaseControl_AF()</strong> has the following required
parameters:</p>
<ul>
<li>Number of cases</li>
<li>Number of controls</li>
<li>Odds Ratio (OR) or beta coefficient</li>
<li>
<strong>AF</strong> for the whole sample (cases and controls
combined)</li>
</ul>
<p><strong>CaseControl_SE()</strong> has the follwoing required
parameters:</p>
<ul>
<li>Number of cases</li>
<li>Number of controls</li>
<li>Odds Ratio (OR) or beta coefficient</li>
<li>
<strong>SE</strong> of the log(OR) for each variant</li>
</ul>
<p><em>Code adapted from ReACt GroupFreq function available here: (<a href="https://github.com/Paschou-Lab/ReAct/blob/main/GrpPRS_src/CountConstruct.c" class="external-link uri">https://github.com/Paschou-Lab/ReAct/blob/main/GrpPRS_src/CountConstruct.c</a>)</em></p>
</div>
</div>
<div class="section level2">
<h2 id="CaseControl_AF">CaseControl_AF<a class="anchor" aria-label="anchor" href="#CaseControl_AF"></a>
</h2>
<div class="section level3">
<h3 id="casecontrol_af-input">CaseControl_AF() input<a class="anchor" aria-label="anchor" href="#casecontrol_af-input"></a>
</h3>
<ul>
<li>
<strong>data</strong>: a dataframe with each row being a variant and
columns for total AF and OR</li>
<li>
<strong>N_case</strong>: an integer for the number of case
samples</li>
<li>
<strong>N_control</strong>: an integer for the number of control
samples</li>
<li>
<strong>OR_colname</strong>: a string containing the exact column
name in <em>data</em> with the odds ratios</li>
<li>
<strong>AF_total_colname</strong>: a string containing the exact
column name in <em>data</em> with the total AFs</li>
</ul>
</div>
<div class="section level3">
<h3 id="casecontrol_af-output">CaseControl_AF() output<a class="anchor" aria-label="anchor" href="#casecontrol_af-output"></a>
</h3>
<p>Returns the original <em>data</em> dataframe with two additional
columns:</p>
<ul>
<li>AF_case</li>
<li>AF_control</li>
</ul>
<p>The number of rows is equal to the number of variants.</p>
</div>
</div>
<div class="section level2">
<h2 id="CaseControl_SE">CaseControl_SE<a class="anchor" aria-label="anchor" href="#CaseControl_SE"></a>
</h2>
<div class="section level3">
<h3 id="casecontrol_se-input">CaseControl_SE() input<a class="anchor" aria-label="anchor" href="#casecontrol_se-input"></a>
</h3>
<p>CaseControl_SE has the following required inputs:</p>
<ul>
<li>
<strong>data</strong>: a dataframe where each row is a variant and
columns for the OR, SE, chromosome, and position</li>
<li>
<strong>N_case</strong>: an integer for the number of case
samples</li>
<li>
<strong>N_control</strong>: an integer for the number of control
samples</li>
<li>
<strong>OR_colname</strong>: a string containing the exact column
name in <em>data</em> with the odds ratios</li>
<li>
<strong>SE_colname</strong>: a string containing the exact column
name in <em>data</em> with the standard errors</li>
<li>
<strong>position_colname</strong>: a string containing the exact
column name in <em>data</em> with the positions of the variants</li>
<li>
<strong>chromosome_colname</strong>: a string containing the exact
column name in <em>data</em> with the chromosome of the variants. Note,
sex chromosomes can be either characters (‘X’, ‘x’, ‘Y’, ‘y’) or numeric
where X=23 and Y=24</li>
<li>
<strong>sex_chromosomes</strong>: boolean, TRUE if variants from sex
chromosome(s) are included in the dataset</li>
<li>
<strong>do_correction</strong>: boolean, TRUE if data is provided to
correct the estimates using proxy MAFs</li>
<li>
<strong>remove_sex_chromosomes</strong>: boolean, TRUE if variants
on sex chromosomes should be removed. This is only necessary if
<em>sex_chromosomes</em> == TRUE and the number of XX/XY individuals per
case and control sample is NOT known</li>
</ul>
<p>CaseControl_SE has the following optional inputs:</p>
<p>If <em>sex_chromosomes</em> == TRUE and
<em>remove_sex_chromosomes</em> == FALSE, the following inputs are
required:</p>
<ul>
<li>
<strong>N_XX_case</strong>: the number of XX chromosome case
individuals</li>
<li>
<strong>N_XX_control</strong>: the number of XX chromosome control
individuals</li>
<li>
<strong>N_XY_case</strong>: the number of XY chromosome case
individuals</li>
<li>
<strong>N_XY_control</strong>: the number of XY chromosome control
individuals</li>
</ul>
<p>If <em>do_correction</em> == TRUE, then data must be provided that
includes harmonized data with proxy MAFs</p>
<ul>
<li>
<strong>correction_data</strong>: a dataframe with the following
EXACT column names: CHR, POS, proxy_MAF, containing data for variants
harmonized between the observed and proxy datasets</li>
</ul>
</div>
<div class="section level3">
<h3 id="casecontrol_se-output">CaseControl_SE() output<a class="anchor" aria-label="anchor" href="#casecontrol_se-output"></a>
</h3>
<p>Returns the <em>data</em> dataframe with three additional
columns:</p>
<ul>
<li>MAF_case</li>
<li>MAF_control</li>
<li>MAF_total</li>
</ul>
<p>Each columns contains the estimated MAF in the cases, controls, and
whole sample, respectively. The number of rows is equal to the number of
variants</p>
<p>If <em>do_correction</em> == TRUE, three additional columns are
included in the dataframe:</p>
<ul>
<li>MAF_case_adj</li>
<li>MAF_control_adj</li>
<li>MAF_total_adj</li>
</ul>
<p>Containing MAFs adjusted using the the proxy MAFs to model the
expected bias.</p>
<p><em>NOTE:</em> This method assumes we are estimating the minor allele
frequency (MAF). The minor allele may or may not be the effect variant
used to calculate AF for the GWAS summary statistics. For additional
details see vignette titled “CaseControlAF Extra Details”</p>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>These examples use the provided sample data which is a subset of 500
variants from chromosome 1 of the Pan-UKBB diabetes GWAS in non-Finnish
European individuals.</p>
<div class="section level3">
<h3 id="a-quick-demo-of-CaseControl_AF">A quick demo of CaseControl_AF()<a class="anchor" aria-label="anchor" href="#a-quick-demo-of-CaseControl_AF"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wolffha/CaseControlAF/" class="external-link">CaseControlAF</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sampleDat"</span><span class="op">)</span></span>
<span><span class="va">sampleDat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results_af</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CaseControl_AF.html">CaseControl_AF</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sampleDat</span>,</span>
<span>                             N_case <span class="op">=</span> <span class="fl">16550</span>,</span>
<span>                             N_control <span class="op">=</span> <span class="fl">403923</span>,</span>
<span>                             OR_colname <span class="op">=</span> <span class="st">"OR"</span>,</span>
<span>                             AF_total_colname <span class="op">=</span> <span class="st">"true_maf_pop"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results_af</span><span class="op">)</span></span>
<span><span class="co">#&gt;    CHR       POS REF ALT true_maf_case true_maf_control       beta      SE</span></span>
<span><span class="co">#&gt; 1 chr1 226824710   C   T     2.048e-01        2.041e-01  0.0003441 0.01471</span></span>
<span><span class="co">#&gt; 2 chr1 117812346   G   A     4.480e-01        4.471e-01 -0.0013920 0.01196</span></span>
<span><span class="co">#&gt; 3 chr1 230838863   C   T     1.647e-01        1.642e-01  0.0042250 0.01620</span></span>
<span><span class="co">#&gt; 4 chr1  93121792 ATT   A     0.000e+00        0.000e+00 -0.1058000 3.53000</span></span>
<span><span class="co">#&gt; 5 chr1 240236388   G   A     1.114e-05        3.775e-05 -1.2540000 1.25300</span></span>
<span><span class="co">#&gt; 6 chr1  12385196   G   A     1.390e-02        1.402e-02 -0.0152700 0.05046</span></span>
<span><span class="co">#&gt;    gnomad_maf        OR true_maf_pop      AF_case   AF_control</span></span>
<span><span class="co">#&gt; 1 2.04050e-01 1.0003442 2.041276e-01 2.041813e-01 2.041254e-01</span></span>
<span><span class="co">#&gt; 2 4.45508e-01 0.9986090 4.471354e-01 4.468049e-01 4.471490e-01</span></span>
<span><span class="co">#&gt; 3 1.82612e-01 1.0042339 1.642197e-01 1.647775e-01 1.641968e-01</span></span>
<span><span class="co">#&gt; 4 1.07925e-04 0.8996046 0.000000e+00 0.000000e+00 0.000000e+00</span></span>
<span><span class="co">#&gt; 5 8.82145e-05 0.2853611 3.670262e-05 1.077692e-05 3.776488e-05</span></span>
<span><span class="co">#&gt; 6 1.15995e-02 0.9848460 1.401528e-02 1.381395e-02 1.402353e-02</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot the results</span></span>
<span><span class="co"># first need minor allele frequency to compare to true_maf_case</span></span>
<span><span class="va">results_af</span><span class="op">$</span><span class="va">MAF_case</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">results_af</span><span class="op">$</span><span class="va">AF_case</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">-</span><span class="va">x</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">results_af</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">results_af</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">results_af</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">true_maf_case</span>, y <span class="op">=</span> <span class="va">MAF_case</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Example CaseControl_AF()"</span><span class="op">)</span></span></code></pre></div>
<p><img src="CaseControlAF_files/figure-html/unnamed-chunk-5-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="a-quick-demo-of-CaseControl_SE">A quick demo of CaseControl_SE()<a class="anchor" aria-label="anchor" href="#a-quick-demo-of-CaseControl_SE"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wolffha/CaseControlAF/" class="external-link">CaseControlAF</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sampleDat"</span><span class="op">)</span></span>
<span><span class="va">sampleDat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># First run without correction</span></span>
<span><span class="va">results_se_noCorr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CaseControl_SE.html">CaseControl_SE</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sampleDat</span>,</span>
<span>                                    N_case <span class="op">=</span> <span class="fl">16550</span>,</span>
<span>                                    N_control <span class="op">=</span> <span class="fl">403923</span>,</span>
<span>                                    OR_colname <span class="op">=</span> <span class="st">"OR"</span>,</span>
<span>                                    SE_colname <span class="op">=</span> <span class="st">"SE"</span>,</span>
<span>                                    chromosome_colname <span class="op">=</span> <span class="st">"CHR"</span>,</span>
<span>                                    position_colname <span class="op">=</span> <span class="st">"POS"</span>,</span>
<span>                                    do_correction <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                    sex_chromosomes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results_se_noCorr</span><span class="op">)</span></span>
<span><span class="co">#&gt;    CHR       POS REF ALT true_maf_case true_maf_control       beta      SE</span></span>
<span><span class="co">#&gt; 1 chr1 226824710   C   T     2.048e-01        2.041e-01  0.0003441 0.01471</span></span>
<span><span class="co">#&gt; 2 chr1 117812346   G   A     4.480e-01        4.471e-01 -0.0013920 0.01196</span></span>
<span><span class="co">#&gt; 3 chr1 230838863   C   T     1.647e-01        1.642e-01  0.0042250 0.01620</span></span>
<span><span class="co">#&gt; 4 chr1  93121792 ATT   A     0.000e+00        0.000e+00 -0.1058000 3.53000</span></span>
<span><span class="co">#&gt; 5 chr1 240236388   G   A     1.114e-05        3.775e-05 -1.2540000 1.25300</span></span>
<span><span class="co">#&gt; 6 chr1  12385196   G   A     1.390e-02        1.402e-02 -0.0152700 0.05046</span></span>
<span><span class="co">#&gt;    gnomad_maf        OR true_maf_pop     MAF_case  MAF_control    MAF_total</span></span>
<span><span class="co">#&gt; 1 2.04050e-01 1.0003442 2.041276e-01 1.764905e-01 1.764405e-01 1.764425e-01</span></span>
<span><span class="co">#&gt; 2 4.45508e-01 0.9986090 4.471354e-01 3.263835e-01 3.266896e-01 3.266776e-01</span></span>
<span><span class="co">#&gt; 3 1.82612e-01 1.0042339 1.642197e-01 1.392353e-01 1.387297e-01 1.387496e-01</span></span>
<span><span class="co">#&gt; 4 1.07925e-04 0.8996046 0.000000e+00 2.513875e-06 2.794421e-06 2.783379e-06</span></span>
<span><span class="co">#&gt; 5 8.82145e-05 0.2853611 3.670262e-05 1.946826e-05 6.821993e-05 6.630105e-05</span></span>
<span><span class="co">#&gt; 6 1.15995e-02 0.9848460 1.401528e-02 1.250050e-02 1.269041e-02 1.268294e-02</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot the results</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">results_se_noCorr</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">true_maf_case</span>, y <span class="op">=</span> <span class="va">MAF_case</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Example CaseControl_SE() No Correction"</span><span class="op">)</span></span></code></pre></div>
<p><img src="CaseControlAF_files/figure-html/unnamed-chunk-6-1.png" width="100%"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wolffha/CaseControlAF/" class="external-link">CaseControlAF</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sampleDat"</span><span class="op">)</span></span>
<span><span class="va">sampleDat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">)</span></span>
<span></span>
<span><span class="va">corr_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>CHR <span class="op">=</span> <span class="va">sampleDat</span><span class="op">$</span><span class="va">CHR</span>,</span>
<span>                        POS <span class="op">=</span> <span class="va">sampleDat</span><span class="op">$</span><span class="va">POS</span>,</span>
<span>                        proxy_MAF <span class="op">=</span> <span class="va">sampleDat</span><span class="op">$</span><span class="va">gnomad_maf</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># now run with correction</span></span>
<span><span class="va">results_se_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CaseControl_SE.html">CaseControl_SE</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sampleDat</span>,</span>
<span>                                  N_case <span class="op">=</span> <span class="fl">16550</span>,</span>
<span>                                  N_control <span class="op">=</span> <span class="fl">403923</span>,</span>
<span>                                  OR_colname <span class="op">=</span> <span class="st">"OR"</span>,</span>
<span>                                  SE_colname <span class="op">=</span> <span class="st">"SE"</span>,</span>
<span>                                  chromosome_colname <span class="op">=</span> <span class="st">"CHR"</span>,</span>
<span>                                  position_colname <span class="op">=</span> <span class="st">"POS"</span>,</span>
<span>                                  do_correction <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                  correction_data <span class="op">=</span> <span class="va">corr_data</span>,</span>
<span>                                  sex_chromosomes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results_se_corr</span><span class="op">)</span></span>
<span><span class="co">#&gt;    CHR       POS REF ALT true_maf_case true_maf_control       beta      SE</span></span>
<span><span class="co">#&gt; 1 chr1 226824710   C   T     2.048e-01        2.041e-01  0.0003441 0.01471</span></span>
<span><span class="co">#&gt; 2 chr1 117812346   G   A     4.480e-01        4.471e-01 -0.0013920 0.01196</span></span>
<span><span class="co">#&gt; 3 chr1 230838863   C   T     1.647e-01        1.642e-01  0.0042250 0.01620</span></span>
<span><span class="co">#&gt; 4 chr1  93121792 ATT   A     0.000e+00        0.000e+00 -0.1058000 3.53000</span></span>
<span><span class="co">#&gt; 5 chr1 240236388   G   A     1.114e-05        3.775e-05 -1.2540000 1.25300</span></span>
<span><span class="co">#&gt; 6 chr1  12385196   G   A     1.390e-02        1.402e-02 -0.0152700 0.05046</span></span>
<span><span class="co">#&gt;    gnomad_maf        OR true_maf_pop     MAF_case  MAF_control    MAF_total</span></span>
<span><span class="co">#&gt; 1 2.04050e-01 1.0003442 2.041276e-01 1.764905e-01 1.764405e-01 1.764425e-01</span></span>
<span><span class="co">#&gt; 2 4.45508e-01 0.9986090 4.471354e-01 3.263835e-01 3.266896e-01 3.266776e-01</span></span>
<span><span class="co">#&gt; 3 1.82612e-01 1.0042339 1.642197e-01 1.392353e-01 1.387297e-01 1.387496e-01</span></span>
<span><span class="co">#&gt; 4 1.07925e-04 0.8996046 0.000000e+00 2.513875e-06 2.794421e-06 2.783379e-06</span></span>
<span><span class="co">#&gt; 5 8.82145e-05 0.2853611 3.670262e-05 1.946826e-05 6.821993e-05 6.630105e-05</span></span>
<span><span class="co">#&gt; 6 1.15995e-02 0.9848460 1.401528e-02 1.250050e-02 1.269041e-02 1.268294e-02</span></span>
<span><span class="co">#&gt;   MAF_case_adj MAF_control_adj MAF_total_adj</span></span>
<span><span class="co">#&gt; 1 2.101173e-01    2.100673e-01  2.100692e-01</span></span>
<span><span class="co">#&gt; 2 4.831277e-01    4.834338e-01  4.834218e-01</span></span>
<span><span class="co">#&gt; 3 1.598885e-01    1.593830e-01  1.594029e-01</span></span>
<span><span class="co">#&gt; 4 2.513875e-06    2.794421e-06  2.783379e-06</span></span>
<span><span class="co">#&gt; 5 1.946826e-05    6.821993e-05  6.630105e-05</span></span>
<span><span class="co">#&gt; 6 8.977955e-03    9.167862e-03  9.160387e-03</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co"># plot the results</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">results_se_corr</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">true_maf_case</span>, y <span class="op">=</span> <span class="va">MAF_case_adj</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Example CaseControl_SE() With Correction"</span><span class="op">)</span></span></code></pre></div>
<p><img src="CaseControlAF_files/figure-html/unnamed-chunk-7-1.png" width="100%"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.1 (2024-06-14 ucrt)</span></span>
<span><span class="co">#&gt; Platform: x86_64-w64-mingw32/x64</span></span>
<span><span class="co">#&gt; Running under: Windows 11 x64 (build 22631)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] LC_COLLATE=English_United States.utf8 </span></span>
<span><span class="co">#&gt; [2] LC_CTYPE=English_United States.utf8   </span></span>
<span><span class="co">#&gt; [3] LC_MONETARY=English_United States.utf8</span></span>
<span><span class="co">#&gt; [4] LC_NUMERIC=C                          </span></span>
<span><span class="co">#&gt; [5] LC_TIME=English_United States.utf8    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: America/Denver</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] lubridate_1.9.3      forcats_1.0.0        stringr_1.5.1       </span></span>
<span><span class="co">#&gt;  [4] dplyr_1.1.4          purrr_1.0.2          readr_2.1.5         </span></span>
<span><span class="co">#&gt;  [7] tidyr_1.3.1          tibble_3.2.1         ggplot2_3.5.1       </span></span>
<span><span class="co">#&gt; [10] tidyverse_2.0.0      CaseControlAF_0.99.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] sass_0.4.9        utf8_1.2.4        generics_0.1.3    stringi_1.8.4    </span></span>
<span><span class="co">#&gt;  [5] hms_1.1.3         digest_0.6.36     magrittr_2.0.3    timechange_0.3.0 </span></span>
<span><span class="co">#&gt;  [9] evaluate_0.24.0   grid_4.4.1        fastmap_1.2.0     jsonlite_1.8.8   </span></span>
<span><span class="co">#&gt; [13] fansi_1.0.6       scales_1.3.0      textshaping_0.4.0 jquerylib_0.1.4  </span></span>
<span><span class="co">#&gt; [17] cli_3.6.3         rlang_1.1.4       munsell_0.5.1     withr_3.0.1      </span></span>
<span><span class="co">#&gt; [21] cachem_1.1.0      yaml_2.3.10       tools_4.4.1       tzdb_0.4.0       </span></span>
<span><span class="co">#&gt; [25] colorspace_2.1-1  vctrs_0.6.5       R6_2.5.1          lifecycle_1.0.4  </span></span>
<span><span class="co">#&gt; [29] fs_1.6.4          htmlwidgets_1.6.4 ragg_1.3.2        pkgconfig_2.0.3  </span></span>
<span><span class="co">#&gt; [33] desc_1.4.3        pkgdown_2.1.0     pillar_1.9.0      bslib_0.8.0      </span></span>
<span><span class="co">#&gt; [37] gtable_0.3.5      glue_1.7.0        systemfonts_1.1.0 highr_0.11       </span></span>
<span><span class="co">#&gt; [41] xfun_0.45         tidyselect_1.2.1  rstudioapi_0.16.0 knitr_1.48       </span></span>
<span><span class="co">#&gt; [45] farver_2.1.2      htmltools_0.5.8.1 labeling_0.4.3    rmarkdown_2.27   </span></span>
<span><span class="co">#&gt; [49] compiler_4.4.1</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Hayley Wolff.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
